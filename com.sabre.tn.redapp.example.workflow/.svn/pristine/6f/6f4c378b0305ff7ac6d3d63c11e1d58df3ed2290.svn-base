package com.sabre.tn.redapp.example.workflow.uiparts;

import org.eclipse.swt.SWT;
import org.eclipse.swt.events.SelectionAdapter;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.events.SelectionListener;
import org.eclipse.swt.layout.FillLayout;
import org.eclipse.swt.layout.GridData;
import org.eclipse.swt.layout.GridLayout;
import org.eclipse.swt.widgets.Button;
import org.eclipse.swt.widgets.Composite;
import org.eclipse.swt.widgets.Group;
import org.eclipse.swt.widgets.Label;
import org.eclipse.swt.widgets.Text;

import com.sabre.edge.cf.core.registry.service.ISRWCommunication;
import com.sabre.edge.cf.emu.data.EmulatorCommand;
import com.sabre.edge.cf.emu.data.requests.EmulatorCommandRequest;
import com.sabre.edge.cf.emu.external.ExecuteInEmuServiceClient;
import com.sabre.edge.cf.emu.external.ShowInEmuServiceClient;
import com.sabre.tn.redapp.example.workflow.Activator;



public class EmuCommandWidget extends Composite {

	
	private Text txtCommand;
	Button btnShow;
	Button btnExec;
	
	public EmuCommandWidget(Composite parent, int style) {
		super(parent, style);
		
		this.setParent(parent);
		this.setLayout(new FillLayout());
		Group compMain = new Group(this,SWT.NONE);
		compMain.setText("EMU Command Services");
		compMain.setLayout(new GridLayout(2, false));
		//compMain.setLayoutData(new GridData(GridData.FILL));
		
		Label lblCommand = new Label(compMain,SWT.NONE);
		lblCommand.setText("Command:");
		
		txtCommand = new Text(compMain,SWT.BORDER);
		txtCommand.setLayoutData(new GridData(GridData.FILL_HORIZONTAL));
		
		Group grTypeCommand = new Group(compMain, SWT.NONE);
		grTypeCommand.setLayout(new FillLayout());
		btnShow = new Button(grTypeCommand,SWT.RADIO);
		btnShow.setText("Show In EMU");
		
		btnExec = new Button(grTypeCommand,SWT.RADIO);
		btnExec.setText("Execute In EMU");
		
		Button btnExecute = new Button(compMain, SWT.NONE);
		btnExecute.setText("Run Command");
		
		btnExecute.addSelectionListener(new SelectionListener() {
			
			@Override
			public void widgetSelected(SelectionEvent arg0) {
				ISRWCommunication comm = Activator.getDefault().getServiceReference(ISRWCommunication.class);
				
				
				String cmdToShow = txtCommand.getText();
				
				EmulatorCommand cmd = new EmulatorCommand(cmdToShow);
				EmulatorCommandRequest rq = new EmulatorCommandRequest(cmd);
				
				if(btnShow.getSelection()){
					ShowInEmuServiceClient showInEmu = new ShowInEmuServiceClient(comm);
					showInEmu.send(rq);	
				}else{
					ExecuteInEmuServiceClient execEmu = new ExecuteInEmuServiceClient(comm);
					execEmu.send(rq);
				}
				
				
			}
			
			@Override
			public void widgetDefaultSelected(SelectionEvent arg0) {
				// TODO Auto-generated method stub
				
			}
		});

		

	
	}

}
